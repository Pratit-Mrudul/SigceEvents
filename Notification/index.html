<!DOCTYPE html>
<html lang="en">
<head>
  <link rel="stylesheet" href="/Preloader/style.css" />
  <script src="/__/firebase/8.6.8/firebase-app.js"></script>
  <script src="/__/firebase/init.js"></script>
  <script src="/__/firebase/8.6.8/firebase-functions.js"></script>
  <script src="/__/firebase/8.6.8/firebase-analytics.js"></script>
  <script src="/__/firebase/8.6.8/firebase-auth.js"></script>
  <script src="/__/firebase/8.6.8/firebase-firestore.js"></script>
  <script src="/Registration/firebase.js" type="text/javascript" charset="utf-8"></script>
  <script src="/Backend/FirebaseAuthentication.js"></script>
  <script src="/Backend/Firebasestore.js"></script>
  <meta charset="UTF-8" />
  <meta content="width=device-width, initial-scale=1" name="viewport" />
  <title>SIGCE Student Notifications</title>
  <link rel="stylesheet" href="/Registration/style.css" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css" integrity="sha512-iBBXm8fW90+nuLcSKlbmrPcLa0OT92xO1BIsZ+ywDWZCvqsWgccV3gFoRBv0z+8dLJgyAHIhR35VZc2oM/gI1w==" crossorigin="anonymous" referrerpolicy="no-referrer" />
  <script src="https://code.jquery.com/jquery-3.6.0.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script>
  <script>
    jQuery(async function() {
      document.getElementById('container').style.display = 'none';
      jQuery('#preloader').load('/Preloader/index.html');
      jQuery('.links').load('/menu.html')

      await firebase.auth().onAuthStateChanged(async (user) => {
      if (user) {
      await getDocumentData(db.collection("users").doc(user.uid));
      let notificationList = userData['participatedEvents'];
      let NotificationSection = document.getElementById('Noticontent');
      NotificationSection.innerHTML = '';
      for (let i = 0; i<notificationList.length; i++) {
        NotificationSection.innerHTML += 
                    `<li><div class="notificationBar">
                      <div class="notiText">
                        <h4>Yay! &nbsp;</h4>
                        <p>
                          You Have Been Registered For ${notificationList[i]}&nbsp;&nbsp;<i class="fas fa-times closeButton ${notificationList[i]}"></i>
                        </p>
                      </div>
                    </div>
                    </li>`
      }
      CloseButtons = document.getElementsByClassName('closeButton');
      for (let i=0; i<CloseButtons.length; i++) {
        CloseButtons[i].addEventListener('click', async (event) => {
          listClasses = event.target().classList.remove('fas', 'fa-times', 'closeButton');
          let email = user.email;
          var eventInstance = db.collection('events').doc(listClasses[0])
          await eventInstance.update({
            [email]: firebase.firestore.FieldValue.delete()
          },);
        })
      };
    }});
      setTimeout(function() {
        document.getElementById('preloader').style.display = 'none';
        document.getElementById('container').style.display = '';
      }, 4500);
        });
  </script>
  <style>
    .notiText {
      text-align: center;
      background-color: #171717 !important;
      display: flex;
      align-items: center;
      justify-content: center;
      border-radius: 10px;
      color: white;
      border-radius: 20px;
      margin: 10px auto;
      padding: 25px;
      height: max-content;
    }
    .notificationBar {
      display: flex;
      align-items: center;
      justify-content: center;
      margin: 8px auto;
    }
    .notificationBar h4 {
      font-size: 16px;
      font-weight: bold;
    }
    .notificationBar p {
      font-size: 16px;
      margin: 0px 18px;
    }
    i{
      color: red;
      margin-left: 15px;
    }
  </style>
</head>

<body>
  <div id="preloader" style="z-index: 1000;">

  </div>
  <div class="container" id="container">
    <div class="navbar">
      <div class="menu">
        <a href="/" style="color: whitesmoke; text-decoration: none;">
          <h3 class="logo">SIGCE <span>Events</span></h3>
        </a>
        <div class="hamburger-menu">
          <div class="bar"></div>
        </div>
      </div>
    </div>
    <div class="main-container">
      <div class="main">
        <header>
          <div class="overlay">
            <div class="inner">
              <div class='notiBack'>
                <h2>Notifications</h2>
                <div class="notiSection">
                  <ul id="Noticontent">
                    <li><div class="notificationBar">
                      <div class="notiText">
                        <h4>&nbsp;</h4>
                        <p>No New Notifications<i class="fas fa-times"></i>
                        </p>
                      </div>
                    </div>
                    </li>`
                  </ul>
                </div>
              </div>
            </div>
          </div>
        </header>
      </div>
      <div class="shadow one"></div>
      <div class="shadow two"></div>
    </div>
    <div class="links" id='menu'></div>
  </div>
  <script src="script.js"></script>
</body>
</html>